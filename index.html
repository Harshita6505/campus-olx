<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Campus OLX — Home</title>
  <link rel="stylesheet" href="css/style.css">
</head>
<body>
  <div class="container">
    <header class="header">
      <a class="brand linkless" href="index.html">
        <div class="logo">CO</div>
        <div>
          <div style="font-weight:800">Campus OLX</div>
          <div class="small">Campus resource exchange</div>
        </div>
      </a>

      <nav class="nav topbar">
        <div class="nav-left nav">
          <a class="navlink" href="index.html">Home</a>
          <a class="navlink" href="about.html">About</a>
          <a class="navlink" href="resources.html">Resources</a>
        </div>

        <div class="nav-right">
  <a class="navlink" href="login.html">Login</a>
  <a class="navlink" href="register.html">Register</a>

  <!-- NEW: favorites badge + export/import -->
  <div class="nav-tools" style="margin-left:8px">
    <a class="navlink" href="favorites.html" title="Favorites">
      <span class="fav-badge">♡ <span id="favCount">0</span></span>
    </a>

    <div class="export-import">
      <button id="exportBtn" class="navlink" style="background:none;border:1px solid transparent;padding:6px 8px;border-radius:8px">Export</button>
      <button id="importBtn" class="navlink" style="background:none;border:1px solid transparent;padding:6px 8px;border-radius:8px">Import</button>
    </div>
  </div>
</div>

      </nav>
    </header>

    <section class="hero">
      <div class="hero-left">
        <h1>Find and exchange books, notes, & campus gear</h1>
        <p class="small">A safe, campus-only marketplace to buy, lend, or exchange resources with fellow students.</p>

        <div class="card search">
          <input id="searchInput" placeholder="Search books, bags, stationery..." />
          <select id="searchCategory">
            <option value="">All categories</option>
            <option value="Books">Books</option>
            <option value="Notes">Notes</option>
            <option value="Stationery">Stationery</option>
            <option value="Bags">Bags</option>
          </select>
          <button class="btn" id="searchBtn">Search (demo)</button>
        </div>

        <div style="margin-top:12px">
          <a class="cta" href="resources.html">Browse Listings</a>
          <a class="cta" href="register.html" style="margin-left:10px;background:var(--accent);color:#073b3b">Post an item</a>
        </div>
      </div>

      <div class="hero-right">
        <div class="card center" style="width:260px">
          <h3>Post your item</h3>
          <p class="small">Create a listing in under a minute to reach your campus.</p>
          <a class="btn" href="register.html">Get Started</a>
        </div>

        <div class="card center" style="width:260px">
          <h3>Verified campus-only</h3>
          <p class="small">Sign up using your campus email for a secure community experience.</p>
        </div>
      </div>
    </section>

    <h3 style="margin-top:18px">Popular resources</h3>
    <div class="grid" id="popular-grid">
      <div class="card item">
        <img src="images/sample.jpg" alt="Intro to Algorithms">
        <h4>Introduction to Algorithms — Cormen (3rd Ed.)</h4>
        <p class="small">Used, good condition. Price: ₹700. Exchange: possible for reference books.</p>
        <div class="resource-meta"><span class="badge">Books</span><span class="small">Posted 3 days ago</span></div>
      </div>

      <div class="card item">
        <img src="images/sample.jpg" alt="Linear Algebra">
        <h4>Linear Algebra Notes — Semester 4</h4>
        <p class="small">PDF + handwritten notes. Great for quick revision. Free.</p>
        <div class="resource-meta"><span class="badge">Notes</span><span class="small">Posted 1 week ago</span></div>
      </div>

      <div class="card item">
        <img src="images/sample.jpg" alt="Backpack">
        <h4>Campus Backpack — Like new</h4>
        <p class="small">Spacious backpack with laptop sleeve. Price: ₹900.</p>
        <div class="resource-meta"><span class="badge">Bags</span><span class="small">Posted 2 days ago</span></div>
      </div>
    </div>

    <!-- New: Available Products (loads from localStorage / demo) -->
    <section id="products" style="margin-top:28px">
      <h3>Available Products</h3>
      <div id="product-list" class="product-grid card" style="padding:18px"></div>
    </section>

    <footer class="footer">
      <div style="display:flex;justify-content:space-between;align-items:center">
        <div>© Campus OLX — Demo frontend</div>
        <div><a href="contact.html" class="linkless">Contact Us</a></div>
      </div>
    </footer>
  </div>
<!-- PRODUCT DETAILS MODAL -->
<div id="modalOverlay" class="modal-overlay" aria-hidden="true">
  <div class="modal card" role="dialog" aria-modal="true" aria-labelledby="modalTitle">
    <button id="closeModal" style="float:right;border:none;background:none;font-weight:800;font-size:18px;cursor:pointer">✕</button>
    <div class="modal-grid">
      <div>
        <img id="modalImage" src="images/sample.jpg" alt="Product image">
      </div>
      <div>
        <h3 id="modalTitle">Product title</h3>
        <div class="meta">
          <span class="badge" id="modalCategory">Category</span>
          <strong id="modalPrice" style="margin-left:8px">₹0</strong>
        </div>
        <p class="small" id="modalDesc" style="margin-top:12px">Description here</p>

        <div class="actions">
          <button id="contactSellerBtn" class="btn">Contact seller</button>
          <button id="toggleFavBtn" class="favorite-btn">♡ Favorite</button>
        </div>

        <div id="contactArea" style="margin-top:12px;display:none">
          <h4 style="margin:6px 0">Contact Seller (demo)</h4>
          <div id="contactThread" class="contact-thread"></div>
          <div style="display:flex;gap:8px;margin-top:8px">
            <input id="contactInput" placeholder="Write a message..." style="flex:1;padding:8px;border-radius:8px;border:1px solid #e6edf3">
            <button id="sendContactBtn" class="btn">Send</button>
          </div>
        </div>

      </div>
    </div>
  </div>
</div>
<!-- JSON Export / Import Modal -->
<div id="jsonModal" class="json-modal" aria-hidden="true">
  <div class="box">
    <button id="closeJsonModal" style="float:right;border:none;background:none;font-weight:800;font-size:18px;cursor:pointer">✕</button>
    <h3>Export / Import Demo Data</h3>
    <p class="small-note">Export all demo data (products, favorites, contact threads) to a JSON file for backup. You can edit or re-import a JSON snapshot to restore.</p>

    <div style="display:flex;gap:8px;margin-top:10px">
      <button id="downloadJson" class="btn">Download JSON</button>
      <label class="btn" style="cursor:pointer">
        Choose JSON<input type="file" id="jsonFile" accept="application/json" style="display:none">
      </label>
      <button id="loadJson" class="btn">Load selected JSON</button>
    </div>

    <p class="small-note" style="margin-top:12px">Or preview/edit the JSON below before importing (careful — importing overwrites existing demo keys):</p>
    <textarea id="jsonPreview" placeholder="JSON preview appears here..."></textarea>
    <div style="margin-top:8px;display:flex;gap:8px">
      <button id="importFromTextarea" class="btn">Import from textarea</button>
      <button id="resetDemo" class="btn" style="background:#ff6b35">Reset demo data</button>
    </div>
  </div>
</div>

  <!-- scripts -->
  <script src="js/send.js"></script>
  <script src="js/script.js"></script>

  <script>
    // small search demo: filter items already present in localStorage
    document.getElementById('searchBtn').addEventListener('click', ()=>{
      const q = document.getElementById('searchInput').value.toLowerCase();
      const cat = document.getElementById('searchCategory').value;
      const list = document.getElementById('product-list');
      const products = JSON.parse(localStorage.getItem('products')) || [];

      const filtered = products.filter(p => {
        const matchesQ = q ? (p.title + ' ' + p.desc).toLowerCase().includes(q) : true;
        const matchesCat = cat ? (p.category === cat) : true;
        return matchesQ && matchesCat;
      });

      if(filtered.length === 0){
        list.innerHTML = '<p class="small">No items match your search (demo)</p>';
        return;
      }

      list.innerHTML = filtered.map(p => `
        <div class="product-card">
          <img src="${p.img || 'images/sample.jpg'}" alt="${p.title}">
          <h4>${p.title}</h4>
          <p class="small">${p.desc}</p>
          <div class="resource-meta"><span class="badge">${p.category || 'Misc'}</span><strong>₹${p.price || '—'}</strong></div>
        </div>
      `).join('');
    });

    // ensure products load on page open
    if (typeof loadProducts === 'function') loadProducts();
  </script>
</body>
</html>
